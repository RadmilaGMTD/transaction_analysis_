# transaction_analysis_
Это приложение для анализа транзакций, которые находятся в Excel-файле. Приложение генерирует JSON-данные для веб-страниц, формирует Excel-отчеты, а также предоставляет другие сервисы.
Структура проекта включает в себя категории:
   * «Веб-страницы»
   * «Сервисы»
   * «Отчеты»
## Установка
1. Клонируйте репозиторий:
```
git@github.com:RadmilaGMTD/transaction_analysis_.git
```
2. Установите зависимости:
```
poetry install
```
## Основные функции
1. Модуль **views.py** в пакете **src** содержит функцию **users_analysis** для категории «Веб-страницы». Функция принимает на вход строку с датой и временем и возвращает JSON-ответ со следующими данными:
   * Приветствие в формате
   * По каждой карте: последние 4 цифры карты, общая сумма расходов, кешбэк (1 рубль на каждые 100 рублей). 
   * Топ-5 транзакций по сумме платежа.
   * Курс валют.
   * Стоимость акций из S&P500.
2. Модуль **services.py** в пакете **src** содержит функцию **users_cash** для категории «Сервисы». Данна функция предназначена для анализа выгодности категорий повышенного кешбэка.
На вход функции поступают данные для анализа, год и месяц. Входные параметры: 
   * данные с транзакциями, 
   * год, за который проводится анализ, 
   * месяц, за который проводится анализ.

   На выходе — JSON с анализом, сколько на каждой категории можно заработать кешбэка в указанном месяце года.
3. Модуль **reports.py** в пакете **src** содержит функцию **spending_by_category** для категории «Отчеты». Функция принимает на вход:
   * датафрейм с транзакциями,
   * название категории,
   * опциональную дату.
   
   Если дата не передана, то берется текущая дата.
   Функция возвращает траты по заданной категории за последние три месяца (от переданной даты).
4. Модуль **main.py** в пакете **src** содержит функцию **main**, которая позволяет получить результат основных реализованных в проекте функциональностей. 
## Вспомогательные функции
Вспомогательные функции, необходимые для работы функций категорий «Главная», «Сервисы», «Отчеты» расположены в модуле 
**utils.py** в пакете **src**.
## Остальные данные
   * Собран шаблон файла **.env** с указанием названий всех переменных, необходимых для работы приложения.
   * Валюты и акции для отображения на веб-страницах задаются в отдельном файле пользовательских настроек 
**user_settings.json** в директории **data**.
   * Данные о транзакциях представлены в файле **operations.xls** в директории **data**.
   * При использовании декоратора **@log** данные отчетов записываются в файл **reports**.
## Декоратор
Декоратор **@log** предназначен для функций-отчетов, он записывает в файл результат, который возвращает функция, формирующая отчет.
   * Декоратор без параметра — записывает данные отчета в файл **reports**.
   * Декоратор с параметром — принимает имя файла в качестве параметра.
## Тесты
Тесты представлены для модулей **utils.py**, **reports.py**, **decorators.py**, **views.py**. В проекте применяется фреймворк тестирования **pytest**. Для его использование необходимо:
1. Установить pytest:
```
poetry add --group dev pytest
```
2. Для того чтобы запустить тесты с оценкой покрытия:
```
pytest --cov
```
3. Отчет будет сгенерирован в файле с названием index.html.